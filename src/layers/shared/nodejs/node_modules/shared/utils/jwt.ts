import 'dotenv/config';
import { sign, verify } from 'jsonwebtoken'
import { SignToken } from 'shared/interfaces'
import { APIGatewayProxyEvent } from 'aws-lambda'

export const getToken = (event: APIGatewayProxyEvent) => {
  return event.headers['Authorization']
    ? event.headers['Authorization'].split(' ')[1]
    : ''
}

export const getAccessToken = (data: SignToken) => {
  return sign(data, process.env.ACCESS_TOKEN_SECRET || '', {
    expiresIn: process.env.ACCESS_TOKEN_LIFE,
  })
}

export const verifyToken = (token: string) => {
  return verify(token, process.env.ACCESS_TOKEN_SECRET || '')
}

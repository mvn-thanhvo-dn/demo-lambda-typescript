import { Repository } from 'typeorm'

import { AppDataSource } from 'models/index'
import { Profile, User } from 'models/entities'

export class ProfileRepository extends Repository<Profile> {
  constructor() {
    super(Profile, AppDataSource.manager)
  }

  public createProfile(name: string, age: number, user: User) {
    return this.save(this.create({ name, age, user }))
  }

  public async updateProfile(id: number, values: {name: string, age: number, birthday: string}) {
    await this.createQueryBuilder()
      .update(Profile)
      .set({...values})
      .where('user.id = :id')
      .setParameters({ id })
      .execute()
  }

  public deleteProfile(id: number) {
    return this.delete(id)
  }
}
